Bootstrap: docker
From: ubuntu:18.04
%labels
    January 2020
    autor : Dominik Handler <Dominik Handler@imba.oeaw.ac.at
    modification : Aurore Comte <aurore.comte@ird.fr>
    Nanopolish v0.11.3

%post
    #apt-get -y update
    #apt -y install software-properties-common
    #add-apt-repository ppa:deadsnakes/ppa  
    apt-get -y update
    apt-get -y install python3.7 python3-setuptools python3-pip
    apt-get -y install wget unzip sudo build-essential zlib1g zlib1g-dev git-core
    apt-get -y install libbz2-dev libncurses5-dev autoconf autotools-dev curl gnuplot liblzma-dev libcrypto++-dev
    python3 -m pip install biopython
    cd /
# minimap2 2.11
    wget https://github.com/lh3/minimap2/releases/download/v2.11/minimap2-2.11.tar.bz2
    tar xfvj minimap2-2.11.tar.bz2
    cd minimap2-2.11 && make
    cd ..
# SEQTK 1.3
    wget https://github.com/lh3/seqtk/archive/v1.3.zip
    unzip v1.3.zip
    cd seqtk-1.3/
    make
    cd ..
# samtools 1.10
    wget https://github.com/samtools/samtools/releases/download/1.10/samtools-1.10.tar.bz2
    tar xfvj samtools-1.10.tar.bz2
    cd samtools-1.10
    ./configure
    make
    make install
    cd ..

# NANOPOLISH 0.11.3
    git clone --recursive https://github.com/jts/nanopolish.git
    cd nanopolish
    git checkout v0.11.3
    make
    cd ..

%environment
    export PATH="/nanopolish:/minimap2-2.11:/samtools-1.10:/seqtk-1.3:${PATH}"
